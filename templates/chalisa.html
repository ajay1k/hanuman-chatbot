<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hanuman Chalisa Player</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Devanagari:wght@400;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        :root { --chalisa-primary: #800000; --chalisa-accent: #ff9933; --chalisa-bg: #1a1a1a; --font-serif: 'Noto Serif Devanagari', serif; --font-sans: 'Inter', sans-serif;}
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-serif); min-height: 100vh; display: flex; flex-direction: column; justify-content: flex-start; align-items: center; padding: 40px 10px; color: var(--chalisa-primary); background: var(--chalisa-bg); overflow-x: hidden; }
        video { position: fixed; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -2; opacity: 0.92; }
        .main-container { margin-top: 20px; text-align: center; display: flex; flex-direction: column; align-items: center; z-index: 2; background: rgba(255, 245, 230, 0.25); backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px); border-radius: 55px; padding: 15px; max-width: 500px; width: 95%; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.35); animation: fadeIn 1.2s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(25px); } to { opacity: 1; transform: translateY(0); } }
        .om-logo::before { content: 'üïâ'; font-size: 3.2em; color: var(--chalisa-accent); text-shadow: 0 0 12px rgba(255, 153, 51, 0.8); animation: glow 2.5s ease-in-out infinite alternate; }
        @keyframes glow { to { text-shadow: 0 0 18px rgba(255, 153, 51, 1); } }
        h1 { font-size: 2.3em; font-weight: 700; margin: 15px 0; }
        .audio-player { margin: 15px 0; }
        .custom-audio-controls { display: flex; align-items: center; gap: 12px; background: rgba(255, 245, 230, 0.3); backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px); padding: 10px 18px; border-radius: 35px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25); border: 1px solid rgba(255, 153, 51, 0.3); }
        .icon-btn { width: 50px; height: 50px; border-radius: 15px; color: #fff5e6; border: none; font-size: 1.6em; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); transition: transform 0.2s; }
        .play-pause-button { background: linear-gradient(145deg, #ff9933, #800000); }
        .play-pause-button:hover { transform: scale(1.1); }
        .progress-bar { flex-grow: 1; height: 5px; background: rgba(255, 245, 230, 0.4); border-radius: 3px; overflow: hidden; cursor: pointer; max-width: 200px; border: 1px solid rgba(128, 0, 0, 0.2); }
        .progress { height: 100%; background: linear-gradient(90deg, #ff9933, #800000); width: 0; border-radius: 3px; }
        .lyrics { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); z-index: 1; text-align: center; font-size: 1.6em; line-height: 1.9; background: rgba(255, 245, 230, 0.25); backdrop-filter: blur(1px); -webkit-backdrop-filter: blur(1px); padding: 10px; border-radius: 10px; min-height: 80px; max-width: 90%; width: auto; }
        .lyrics span { display: none; animation: lyricFade 0.6s ease-in-out; }
        .lyrics span.highlight { display: block; }
        @keyframes lyricFade { from { opacity: 0; } to { opacity: 1; } }
        .video-error { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: url("{{ url_for('static', filename='hanuman-bg.jpg') }}") no-repeat center/cover fixed; z-index: -1; }
        .back-button { color: white; position: fixed; top: 20px; left: 20px; text-decoration: none; font-size: 1.5rem; z-index: 1000; transition: transform 0.2s; }
        .back-button:hover { transform: scale(1.1); }
        .chat-bubble { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: linear-gradient(135deg, #ffc107, #ff9800); color: white; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 1.8rem; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.3); transition: transform 0.2s ease-in-out; z-index: 999; }
        .chat-bubble:hover { transform: scale(1.1); }
        .chat-widget { position: fixed; bottom: 100px; right: 30px; width: 90%; max-width: 400px; height: 70vh; max-height: 600px; background-color: #1a2233; border-radius: 20px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2); display: flex; flex-direction: column; overflow: hidden; z-index: 998; transform: translateY(20px) scale(0.95); opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .chat-widget.visible { transform: translateY(0) scale(1); opacity: 1; visibility: visible; }
        .chat-widget .header { background: linear-gradient(135deg, #ffc107, #ff9800); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; }
        .chat-widget .header h2 { font-family: var(--font-sans); font-size: 1.2em; margin: 0; }
        .chat-widget .header .close-btn { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }
        .chat-widget #chat-window { flex-grow: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; font-family: var(--font-sans); }
        .chat-widget .message { display: flex; align-items: flex-start; gap: 10px; max-width: 85%; font-size: 0.9em; animation: fadeIn 0.5s ease-out; }
        .chat-widget .message-content { padding: 10px 15px; border-radius: 18px; line-height: 1.5; word-wrap: break-word; }
        .chat-widget .bot-message { align-self: flex-start; }
        .chat-widget .user-message { align-self: flex-end; flex-direction: row-reverse; }
        .chat-widget .bot-message .message-content { background-color: #2a344a; color: #f0f0f0; }
        .chat-widget .user-message .message-content { background: linear-gradient(45deg, #ff9800, #ff5722); color: white; }
        .chat-widget .avatar { display: none; }
        .chat-widget #chat-form-container { padding: 10px; border-top: 1px solid rgba(255,255,255,0.1); }
        .chat-widget #chat-form { display: flex; gap: 10px; }
        .chat-widget #chat-input { flex-grow: 1; border: none; background-color: #2a344a; border-radius: 20px; padding: 10px 15px; font-size: 1em; color: #f0f0f0; font-family: var(--font-sans); }
        .chat-widget #send-button { background-color: #ff9800; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; flex-shrink: 0; cursor: pointer; }
    </style>
</head>
<body>
    <a href="{{ url_for('chat') }}" class="back-button" aria-label="Back to Chat"><i class="fas fa-arrow-left"></i></a>
    <video autoplay muted loop id="background-video" preload="auto">
        <source src="{{ url_for('static', filename='hanuman.mp4') }}" type="video/mp4">
    </video>
    <div class="video-error" id="videoError"></div>
    <div class="main-container">
        <div class="om-logo"></div>
        <h1>Hanuman Chalisa</h1>
        <div class="audio-player">
            <audio id="hanumanAudio" preload="auto" src="{{ url_for('static', filename='hanuman-chalisa.mp3') }}"></audio>
            <div class="custom-audio-controls">
                <button id="playPauseButton" class="icon-btn play-pause-button"><i class="fas fa-play"></i></button>
                <div class="progress-bar" id="progressBar"><div class="progress" id="progress"></div></div>
            </div>
        </div>
    </div>
    <div class="lyrics" id="lyrics">
        <span>‡§∂‡•ç‡§∞‡•Ä‡§ó‡•Å‡§∞‡•Å ‡§ö‡§∞‡§® ‡§∏‡§∞‡•ã‡§ú ‡§∞‡§ú ‡§®‡§ø‡§ú ‡§Æ‡§®‡•Å ‡§Æ‡•Å‡§ï‡•Å‡§∞‡•Å ‡§∏‡•Å‡§ß‡§æ‡§∞‡§ø‡•§ ‡§¨‡§∞‡§®‡§â‡§Å ‡§∞‡§ò‡•Å‡§¨‡§∞ ‡§¨‡§ø‡§Æ‡§≤ ‡§ú‡§∏‡•Å ‡§ú‡•ã ‡§¶‡§æ‡§Ø‡§ï‡•Å ‡§´‡§≤ ‡§ö‡§æ‡§∞‡§ø‡•§</span>
        <span>‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø‡§π‡•Ä‡§® ‡§§‡§®‡•Å ‡§ú‡§æ‡§®‡§ø‡§ï‡•á ‡§∏‡•Å‡§Æ‡§ø‡§∞‡•å ‡§™‡§µ‡§® ‡§ï‡•Å‡§Æ‡§æ‡§∞‡•§ ‡§¨‡§≤ ‡§¨‡•Å‡§¶‡•ç‡§ß‡§ø ‡§¨‡§ø‡§¶‡•ç‡§Ø‡§æ ‡§¶‡•á‡§π‡•Å ‡§Æ‡•ã‡§π‡§ø ‡§π‡§∞‡§π‡•Å ‡§ï‡§≤‡•á‡§∏ ‡§¨‡§ø‡§ï‡§æ‡§∞‡•§</span>
        <span>‡§ú‡§Ø ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ú‡•ç‡§û‡§æ‡§® ‡§ó‡•Å‡§® ‡§∏‡§æ‡§ó‡§∞‡•§ ‡§ú‡§Ø ‡§ï‡§™‡•Ä‡§∏ ‡§§‡§ø‡§π‡•Å‡§Å ‡§≤‡•ã‡§ï ‡§â‡§ú‡§æ‡§ó‡§∞‡•§</span>
        <span>‡§∞‡§æ‡§Æ ‡§¶‡•Ç‡§§ ‡§Ö‡§§‡•Å‡§≤‡§ø‡§§ ‡§¨‡§≤ ‡§ß‡§æ‡§Æ‡§æ‡•§ ‡§Ö‡§Ç‡§ú‡§®‡§ø ‡§™‡•Å‡§§‡•ç‡§∞ ‡§™‡§µ‡§®‡§∏‡•Å‡§§ ‡§®‡§æ‡§Æ‡§æ‡•§</span>
        <span>‡§Æ‡§π‡§æ‡§¨‡•Ä‡§∞ ‡§¨‡§ø‡§ï‡•ç‡§∞‡§Æ ‡§¨‡§ú‡§∞‡§Ç‡§ó‡•Ä‡•§ ‡§ï‡•Å‡§Æ‡§§‡§ø ‡§®‡§ø‡§µ‡§æ‡§∞ ‡§∏‡•Å‡§Æ‡§§‡§ø ‡§ï‡•á ‡§∏‡§Ç‡§ó‡•Ä‡•§</span>
        <span>‡§ï‡§Ç‡§ö‡§® ‡§¨‡§∞‡§® ‡§¨‡§ø‡§∞‡§æ‡§ú ‡§∏‡•Å‡§¨‡•á‡§∏‡§æ‡•§ ‡§ï‡§æ‡§®‡§® ‡§ï‡•Å‡§Ç‡§°‡§≤ ‡§ï‡•Å‡§Å‡§ö‡§ø‡§§ ‡§ï‡•á‡§∏‡§æ‡•§</span>
        <span>‡§π‡§æ‡§• ‡§¨‡§ú‡•ç‡§∞ ‡§Ö‡§â ‡§ß‡•ç‡§µ‡§ú‡§æ ‡§¨‡§ø‡§∞‡§æ‡§ú‡•à‡•§ ‡§ï‡§æ‡§Å‡§ß‡•á ‡§Æ‡•Ç‡§Å‡§ú ‡§ú‡§®‡•á‡§ä ‡§∏‡§æ‡§ú‡•à‡•§</span>
        <span>‡§∂‡§Ç‡§ï‡§∞ ‡§∏‡•Å‡§µ‡§® ‡§ï‡•á‡§∏‡§∞‡•Ä ‡§®‡§Ç‡§¶‡§®‡•§ ‡§§‡•á‡§ú ‡§™‡•ç‡§∞‡§§‡§æ‡§™ ‡§Æ‡§π‡§æ ‡§ú‡§ó ‡§¨‡§®‡•ç‡§¶‡§®‡•§</span>
        <span>‡§¨‡§ø‡§¶‡•ç‡§Ø‡§æ‡§µ‡§æ‡§® ‡§ó‡•Å‡§®‡•Ä ‡§Ö‡§§‡§ø ‡§ö‡§æ‡§§‡•Å‡§∞‡•§ ‡§∞‡§æ‡§Æ ‡§ï‡§æ‡§ú ‡§ï‡§∞‡§ø‡§¨‡•á ‡§ï‡•ã ‡§Ü‡§§‡•Å‡§∞‡•§</span>
        <span>‡§™‡•ç‡§∞‡§≠‡•Å ‡§ö‡§∞‡§ø‡§§‡•ç‡§∞ ‡§∏‡•Å‡§®‡§ø‡§¨‡•á ‡§ï‡•ã ‡§∞‡§∏‡§ø‡§Ø‡§æ‡•§ ‡§∞‡§æ‡§Æ ‡§≤‡§ñ‡§® ‡§∏‡•Ä‡§§‡§æ ‡§Æ‡§® ‡§¨‡§∏‡§ø‡§Ø‡§æ‡•§</span>
        <span>‡§∏‡•Ç‡§ï‡•ç‡§∑‡•ç‡§Æ ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§∏‡§ø‡§Ø‡§π‡§ø ‡§¶‡§ø‡§ñ‡§æ‡§µ‡§æ‡•§ ‡§¨‡§ø‡§ï‡§ü ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§≤‡§Ç‡§ï ‡§ú‡§∞‡§æ‡§µ‡§æ‡•§</span>
        <span>‡§≠‡•Ä‡§Æ ‡§∞‡•Ç‡§™ ‡§ß‡§∞‡§ø ‡§Ö‡§∏‡•Å‡§∞ ‡§∏‡§Å‡§π‡§æ‡§∞‡•á‡•§ ‡§∞‡§æ‡§Æ‡§ö‡§®‡•ç‡§¶‡•ç‡§∞ ‡§ï‡•á ‡§ï‡§æ‡§ú ‡§∏‡§Å‡§µ‡§æ‡§∞‡•á‡•§</span>
        <span>‡§≤‡§æ‡§Ø ‡§∏‡§ú‡•Ä‡§µ‡§® ‡§≤‡§ñ‡§® ‡§ú‡§ø‡§Ø‡§æ‡§Ø‡•á‡•§ ‡§∂‡•ç‡§∞‡•Ä ‡§∞‡§ò‡•Å‡§¨‡•Ä‡§∞ ‡§π‡§∞‡§∑‡§ø ‡§â‡§∞ ‡§≤‡§æ‡§Ø‡•á‡•§</span>
        <span>‡§∞‡§ò‡•Å‡§™‡§§‡§ø ‡§ï‡•Ä‡§®‡•ç‡§π‡•Ä ‡§¨‡§π‡•Å‡§§ ‡§¨‡§°‡§º‡§æ‡§à‡•§ ‡§§‡•Å‡§Æ ‡§Æ‡§Æ ‡§™‡•ç‡§∞‡§ø‡§Ø ‡§≠‡§∞‡§§‡§π‡§ø ‡§∏‡§Æ ‡§≠‡§æ‡§à‡•§</span>
        <span>‡§∏‡§π‡§∏ ‡§¨‡§¶‡§® ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•ã ‡§ú‡§∏ ‡§ó‡§æ‡§µ‡•à‡§Ç‡•§ ‡§Ö‡§∏ ‡§ï‡§π‡§ø ‡§∂‡•ç‡§∞‡•Ä‡§™‡§§‡§ø ‡§ï‡§Ç‡§† ‡§≤‡§ó‡§æ‡§µ‡•à‡§Ç‡•§</span>
        <span>‡§∏‡§®‡§ï‡§æ‡§¶‡§ø‡§ï ‡§¨‡•ç‡§∞‡§π‡•ç‡§Æ‡§æ‡§¶‡§ø ‡§Æ‡•Å‡§®‡•Ä‡§∏‡§æ‡•§ ‡§®‡§æ‡§∞‡§¶ ‡§∂‡§æ‡§∞‡§¶ ‡§∏‡§π‡§ø‡§§ ‡§Ö‡§π‡•Ä‡§∏‡§æ‡•§</span>
        <span>‡§ú‡§Æ ‡§ï‡•Å‡§¨‡•á‡§∞ ‡§¶‡§ø‡§ó‡§™‡§æ‡§≤ ‡§ú‡§π‡§æ‡§Å ‡§§‡•á‡•§ ‡§ï‡§¨‡§ø ‡§ï‡•ã‡§¨‡§ø‡§¶ ‡§ï‡§π‡§ø ‡§∏‡§ï‡•á ‡§ï‡§π‡§æ‡§Å ‡§§‡•á‡•§</span>
        <span>‡§§‡•Å‡§Æ ‡§â‡§™‡§ï‡§æ‡§∞ ‡§∏‡•Å‡§ó‡•ç‡§∞‡•Ä‡§µ‡§π‡§ø ‡§ï‡•Ä‡§®‡•ç‡§π‡§æ‡•§ ‡§∞‡§æ‡§Æ ‡§Æ‡§ø‡§≤‡§æ‡§Ø ‡§∞‡§æ‡§ú ‡§™‡§¶ ‡§¶‡•Ä‡§®‡•ç‡§π‡§æ‡•§</span>
        <span>‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•ã ‡§Æ‡§Ç‡§§‡•ç‡§∞ ‡§¨‡§ø‡§≠‡•Ä‡§∑‡§£ ‡§Æ‡§æ‡§®‡§æ‡•§ ‡§≤‡§Ç‡§ï‡•á‡§∂‡•ç‡§µ‡§∞ ‡§≠‡•à ‡§∏‡§¨ ‡§ú‡§ó ‡§ú‡§æ‡§®‡§æ‡•§</span>
        <span>‡§ú‡•Å‡§ó ‡§∏‡§π‡§∏‡•ç‡§∞ ‡§ú‡•ã‡§ú‡§® ‡§™‡§∞ ‡§≠‡§æ‡§®‡•Å‡•§ ‡§≤‡•Ä‡§≤‡•ç‡§Ø‡•ã ‡§§‡§æ‡§π‡§ø ‡§Æ‡§ß‡•Å‡§∞ ‡§´‡§≤ ‡§ú‡§æ‡§®‡•Å‡•§</span>
        <span>‡§™‡•ç‡§∞‡§≠‡•Å ‡§Æ‡•Å‡§¶‡•ç‡§∞‡§ø‡§ï‡§æ ‡§Æ‡•á‡§≤‡§ø ‡§Æ‡•Å‡§ñ ‡§Æ‡§æ‡§π‡•Ä‡§Ç‡•§ ‡§ú‡§≤‡§ß‡§ø ‡§≤‡§æ‡§Ç‡§ò‡§ø ‡§ó‡§Ø‡•á ‡§Ö‡§ö‡§∞‡§ú ‡§®‡§æ‡§π‡•Ä‡§Ç‡•§</span>
        <span>‡§¶‡•Å‡§∞‡•ç‡§ó‡§Æ ‡§ï‡§æ‡§ú ‡§ú‡§ó‡§§ ‡§ï‡•á ‡§ú‡•á‡§§‡•á‡•§ ‡§∏‡•Å‡§ó‡§Æ ‡§Ö‡§®‡•Å‡§ó‡•ç‡§∞‡§π ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§§‡•á‡§§‡•á‡•§</span>
        <span>‡§∞‡§æ‡§Æ ‡§¶‡•Å‡§Ü—Ä–µ ‡§§‡•Å‡§Æ ‡§∞‡§ñ‡§µ‡§æ‡§∞‡•á‡•§ ‡§π‡•ã‡§§ ‡§® ‡§Ü‡§ú‡•ç‡§û‡§æ ‡§¨‡§ø‡§®‡•Å ‡§™‡•à‡§∏‡§æ‡§∞‡•á‡•§</span>
        <span>‡§∏‡§¨ ‡§∏‡•Å‡§ñ ‡§≤‡§π‡•à ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡•Ä ‡§∂‡§∞‡§®‡§æ‡•§ ‡§§‡•Å‡§Æ ‡§∞‡§ï‡•ç‡§∑‡§ï ‡§ï‡§æ‡§π‡•Å ‡§ï‡•ã ‡§°‡§∞ ‡§®‡§æ‡•§</span>
        <span>‡§Ü‡§™‡§® ‡§§‡•á‡§ú ‡§∏‡§Æ‡•ç‡§π‡§æ‡§∞‡•ã ‡§Ü‡§™‡•à‡•§ ‡§§‡•Ä‡§®‡•ã‡§Ç ‡§≤‡•ã‡§ï ‡§π‡§æ‡§Ç‡§ï ‡§§‡•á‡§Ç ‡§ï‡§æ‡§Ç‡§™‡•à‡•§</span>
        <span>‡§≠‡•Ç‡§§ ‡§™‡§ø‡§∏‡§æ‡§ö ‡§®‡§ø‡§ï‡§ü ‡§®‡§π‡§ø‡§Ç ‡§Ü‡§µ‡•à‡•§ ‡§Æ‡§π‡§æ‡§¨‡•Ä‡§∞ ‡§ú‡§¨ ‡§®‡§æ‡§Æ ‡§∏‡•Å‡§®‡§æ‡§µ‡•à‡•§</span>
        <span>‡§®‡§æ‡§∏‡•à ‡§∞‡•ã‡§ó ‡§π‡§∞‡•à ‡§∏‡§¨ ‡§™‡•Ä‡§∞‡§æ‡•§ ‡§ú‡§™‡§§ ‡§®‡§ø‡§∞‡§Ç‡§§‡§∞ ‡§π‡§®‡•Å‡§Æ‡§§ ‡§¨‡•Ä‡§∞‡§æ‡•§</span>
        <span>‡§∏‡§Ç‡§ï‡§ü ‡§§‡•á‡§Ç ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§õ‡•Å‡§°‡§æ‡§µ‡•à‡•§ ‡§Æ‡§® ‡§ï‡•ç‡§∞‡§Æ ‡§¨‡§ö‡§® ‡§ß‡•ç‡§Ø‡§æ‡§® ‡§ú‡•ã ‡§≤‡§æ‡§µ‡•à‡•§</span>
        <span>‡§∏‡§¨ ‡§™‡§∞ ‡§∞‡§æ‡§Æ ‡§§‡§™‡§∏‡•ç‡§µ‡•Ä ‡§∞‡§æ‡§ú‡§æ‡•§ ‡§§‡§ø‡§® ‡§ï‡•á ‡§ï‡§æ‡§ú ‡§∏‡§ï‡§≤ ‡§§‡•Å‡§Æ ‡§∏‡§æ‡§ú‡§æ‡•§</span>
        <span>‡§î‡§∞ ‡§Æ‡§®‡•ã‡§∞‡§• ‡§ú‡•ã ‡§ï‡•ã‡§à ‡§≤‡§æ‡§µ‡•à‡•§ ‡§∏‡•ã‡§á ‡§Ö‡§Æ‡§ø‡§§ ‡§ú‡•Ä‡§µ‡§® ‡§´‡§≤ ‡§™‡§æ‡§µ‡•à‡•§</span>
        <span>‡§ö‡§æ‡§∞‡•ã‡§Ç ‡§ú‡•Å‡§ó ‡§™‡§∞‡§§‡§æ‡§™ ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§∞‡§æ‡•§ ‡§π‡•à ‡§™‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß ‡§ú‡§ó‡§§ ‡§â‡§ú‡§ø‡§Ø‡§æ‡§∞‡§æ‡•§</span>
        <span>‡§∏‡§æ‡§ß‡•Å ‡§∏‡§®‡•ç‡§§ ‡§ï‡•á ‡§§‡•Å‡§Æ ‡§∞‡§ñ‡§µ‡§æ‡§∞‡•á‡•§ ‡§Ö‡§∏‡•Å‡§∞ ‡§®‡§ø‡§ï‡§Ç‡§¶‡§® ‡§∞‡§æ‡§Æ ‡§¶‡•Å‡§≤‡§æ‡§∞‡•á‡•§</span>
        <span>‡§Ö‡§∑‡•ç‡§ü ‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø ‡§®‡•å ‡§®‡§ø‡§ß‡§ø ‡§ï‡•á ‡§¶‡§æ‡§§‡§æ‡•§ ‡§Ö‡§∏ ‡§¨‡§∞ ‡§¶‡•Ä‡§® ‡§ú‡§æ‡§®‡§ï‡•Ä ‡§Æ‡§æ‡§§‡§æ‡•§</span>
        <span>‡§∞‡§æ‡§Æ ‡§∞‡§∏‡§æ‡§Ø‡§® ‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§™‡§æ‡§∏‡§æ‡•§ ‡§∏‡§¶‡§æ ‡§∞‡§π‡•ã ‡§∞‡§ò‡•Å‡§™‡§§‡§ø ‡§ï‡•á ‡§¶‡§æ‡§∏‡§æ‡•§</span>
        <span>‡§§‡•Å‡§Æ‡•ç‡§π‡§∞‡•á ‡§≠‡§ú‡§® ‡§∞‡§æ‡§Æ ‡§ï‡•ã ‡§™‡§æ‡§µ‡•à‡•§ ‡§ú‡§®‡§Æ ‡§ú‡§®‡§Æ ‡§ï‡•á ‡§¶‡•Å‡§ñ ‡§¨‡§ø‡§∏‡§∞‡§æ‡§µ‡•à‡•§</span>
        <span>‡§Ö‡§Ç‡§§ ‡§ï‡§æ‡§≤ ‡§∞‡§ò‡•Å‡§¨‡•Ä‡§∞ ‡§™‡•Å‡§∞ ‡§ú‡§æ‡§à‡•§ ‡§ú‡§π‡§æ‡§Å ‡§ú‡§®‡•ç‡§Æ ‡§π‡§∞‡§ø ‡§≠‡§ï‡•ç‡§§ ‡§ï‡§π‡§æ‡§à‡•§</span>
        <span>‡§î‡§∞ ‡§¶‡•á‡§µ‡§§‡§æ ‡§ö‡§ø‡§§ ‡§® ‡§ß‡§∞‡§à‡•§ ‡§π‡§®‡•Å‡§Æ‡§§ ‡§∏‡•á‡§á ‡§∏‡§∞‡•ç‡§¨ ‡§∏‡•Å‡§ñ ‡§ï‡§∞‡§à‡•§</span>
        <span>‡§∏‡§Ç‡§ï‡§ü ‡§ï‡§ü‡•à ‡§Æ‡§ø‡§ü‡•à ‡§∏‡§¨ ‡§™‡•Ä‡§∞‡§æ‡•§ ‡§ú‡•ã ‡§∏‡•Å‡§Æ‡§ø‡§∞‡•à ‡§π‡§®‡•Å‡§Æ‡§§ ‡§¨‡§≤ ‡§¨‡•Ä‡§∞‡§æ‡•§</span>
        <span>‡§ú‡§Ø ‡§ú‡§Ø ‡§ú‡§Ø ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ó‡•ã‡§∏‡§æ‡§à‡§Ç‡•§ ‡§ï‡•É‡§™‡§æ ‡§ï‡§∞‡§π‡•Å ‡§ó‡•Å‡§∞‡•Å‡§¶‡•á‡§µ ‡§ï‡•Ä ‡§®‡§æ‡§à‡§Ç‡•§</span>
        <span>‡§ú‡•ã ‡§∏‡§§ ‡§¨‡§æ‡§∞ ‡§™‡§æ‡§† ‡§ï‡§∞ ‡§ï‡•ã‡§à‡•§ ‡§õ‡•Ç‡§ü‡§π‡§ø ‡§¨‡§Ç‡§¶‡§ø ‡§Æ‡§π‡§æ ‡§∏‡•Å‡§ñ ‡§π‡•ã‡§à‡•§</span>
        <span>‡§ú‡•ã ‡§Ø‡§π ‡§™‡§¢‡§º‡•à ‡§π‡§®‡•Å‡§Æ‡§æ‡§® ‡§ö‡§æ‡§≤‡•Ä‡§∏‡§æ‡•§ ‡§π‡•ã‡§Ø ‡§∏‡§ø‡§¶‡•ç‡§ß‡§ø ‡§∏‡§æ‡§ñ‡•Ä ‡§ó‡•å‡§∞‡•Ä‡§∏‡§æ‡•§</span>
        <span>‡§§‡•Å‡§≤‡§∏‡•Ä‡§¶‡§æ‡§∏ ‡§∏‡§¶‡§æ ‡§π‡§∞‡§ø ‡§ö‡•á‡§∞‡§æ‡•§ ‡§ï‡•Ä‡§ú‡•à ‡§®‡§æ‡§• ‡§π‡•É‡§¶‡§Ø ‡§Æ‡§Ç‡§π ‡§°‡•á‡§∞‡§æ‡•§</span>
        <span>‡§™‡§µ‡§® ‡§§‡§®‡§Ø ‡§∏‡§Ç‡§ï‡§ü ‡§π‡§∞‡§® ‡§Æ‡§Ç‡§ó‡§≤ ‡§Æ‡•Ç‡§∞‡§§‡§ø ‡§∞‡•Ç‡§™‡•§ ‡§∞‡§æ‡§Æ ‡§≤‡§ñ‡§® ‡§∏‡•Ä‡§§‡§æ ‡§∏‡§π‡§ø‡§§ ‡§π‡•É‡§¶‡§Ø ‡§¨‡§∏‡§π‡•Å ‡§∏‡•Å‡§∞ ‡§≠‡•Ç‡§™‡•§</span>
    </div>

    <div class="chat-bubble" id="chat-bubble"><i class="fa-solid fa-comment-dots"></i></div>
    <div class="chat-widget" id="chat-widget">
        <div class="header">
            <h2>Hanuman Sevak</h2>
            <button class="close-btn" id="close-chat-widget">&times;</button>
        </div>
        <div id="chat-window"></div>
        <div id="chat-form-container">
            <form id="chat-form">
                <input type="text" id="chat-input" placeholder="Ask a question..." autocomplete="off">
                <button type="submit" id="send-button" class="icon-button"><i class="fa-solid fa-paper-plane"></i></button>
            </form>
        </div>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", () => {
        // --- CHALISA PLAYER ELEMENTS ---
        const audio = document.getElementById('hanumanAudio');
        const lyricsContainer = document.getElementById('lyrics');
        const lyricSpans = Array.from(lyricsContainer.getElementsByTagName('span'));
        const progressBar = document.getElementById('progressBar');
        const progress = document.getElementById('progress');
        const playPauseButton = document.getElementById('playPauseButton');
        // IMPORTANT: This is a placeholder timing array. You must update this
        // by listening to your MP3 file and noting the start time of each verse.
        const lyricTimings = [0, 6.0 , 47.0, 125.0, 136.0, 23.6, 28.0, 32.5, 37.0, 41.5, 46.0, 50.5, 55.0, 59.5, 64.0, 68.5, 73.0, 77.5, 82.0, 86.5, 91.0, 95.5, 100.0, 104.5, 109.0, 113.5, 118.0, 122.5, 127.0, 131.5, 136.0, 140.5, 145.0, 149.5, 154.0, 158.5, 163.0, 167.5, 172.0, 176.5, 181.0, 185.5, 190.0, 194.5, 199.0, 203.5]; 
        let currentLine = -1;

        // --- CHAT WIDGET ELEMENTS ---
        const chatBubble = document.getElementById("chat-bubble");
        const chatWidget = document.getElementById("chat-widget");
        const closeBtn = document.getElementById("close-chat-widget");
        const chatForm = document.getElementById("chat-form");
        const chatInput = document.getElementById("chat-input");
        const chatWindow = document.getElementById("chat-window");

        // --- CHALISA PLAYER LOGIC ---
        function updateLyrics() {
            if (!audio || audio.paused) return;
            const currentTime = audio.currentTime;
            let lineIndex = -1;
            for(let i = 0; i < lyricTimings.length; i++) {
                if (currentTime >= lyricTimings[i]) { lineIndex = i; } else { break; }
            }
            if (lineIndex !== -1 && lineIndex !== currentLine) {
                lyricSpans.forEach(span => span.classList.remove('highlight'));
                if (lyricSpans[lineIndex]) {
                    lyricSpans[lineIndex].classList.add('highlight');
                }
                currentLine = lineIndex;
            }
        }
        function updateProgress() { if (audio && audio.duration) { progress.style.width = `${(audio.currentTime / audio.duration) * 100}%`; } }
        function seek(event) {
            if (!audio.duration) return;
            const width = progressBar.clientWidth;
            const clickX = event.offsetX;
            audio.currentTime = (clickX / width) * audio.duration;
        }
        
        playPauseButton.addEventListener('click', () => {
            if (audio.paused) { audio.play(); playPauseButton.innerHTML = '<i class="fas fa-pause"></i>'; } 
            else { audio.pause(); playPauseButton.innerHTML = '<i class="fas fa-play"></i>'; }
        });
        audio.addEventListener('timeupdate', () => { updateProgress(); updateLyrics(); });
        if(progressBar) progressBar.addEventListener('click', seek);
        audio.addEventListener('ended', () => { playPauseButton.innerHTML = '<i class="fas fa-play"></i>'; });

        // --- CHAT WIDGET LOGIC ---
        chatBubble.addEventListener('click', () => chatWidget.classList.toggle('visible'));
        closeBtn.addEventListener('click', () => chatWidget.classList.remove('visible'));

        chatForm.addEventListener("submit", (event) => {
            event.preventDefault();
            const userMessage = chatInput.value.trim();
            if (userMessage) processChatMessage(userMessage);
        });
        
        async function processChatMessage(message) {
            appendChatMessage(message, "user");
            chatInput.value = "";
            try {
                const response = await fetch("{{ url_for('get_chat_response') }}", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ message: message }),
                });
                if (!response.ok) throw new Error("Network response not ok.");
                const data = await response.json();
                appendChatMessage(data.response, "bot");
            } catch (error) {
                appendChatMessage("I apologize, an error occurred.", "bot");
            }
        }
        function appendChatMessage(message, type) {
            const messageContainer = document.createElement("div");
            messageContainer.className = `message ${type === 'user' ? 'user-message' : 'bot-message'}`;
            messageContainer.innerHTML = `<div class="message-content">${message.replace(/\n/g, '<br>')}</div>`;
            chatWindow.appendChild(messageContainer);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        // Handle video background error
        const video = document.getElementById('background-video');
        if (video) {
            const videoError = document.getElementById('videoError');
            video.onerror = () => {
                video.style.display = 'none';
                videoError.style.display = 'block';
            };
        }
    });
    </script>
</body>
</html>